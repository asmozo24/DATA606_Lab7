---
title: "DATA606 Chap7 Lab7 Inference for numerical data"
author: "Alexis Mekueko"
date: "10/16/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Github link: https://github.com/asmozo24/DATA606_Homework7
Web Link : file:///C:/Users/Petit%20Mandela/Documents/R/DATA606_Homework7/DATA606_Homework7/DATA606_Homework7.html



```{r load-packages, message=FALSE}

library(tidyverse) #loading all library needed for this assignment
library(openintro)
library(infer)
library(gplots)

library(httr)
library(rvest)
library(xml2)
#head(fastfood)
#library(readxl)
#library(data.table)
#library(readr)
#library(plyr)
#library(dplyr)
#library(dice)
# #library(VennDiagram)
# #library(help = "dice")
#library(DBI)
#library(dbplyr)

#library(rstudioapi)
#library(RJDBC)
#library(odbc)
#library(RSQLite)
#library(rvest)
#library(stringr)
#library(readtext)
#library(ggpubr)
#library(fitdistrplus)
#library(ggplot2)
#library(moments)
#library(qualityTools)
library(normalp)
#library(utils)
#library(MASS)
#library(qqplotr)
library(DATA606)
getLabs()
library(knitr)
#library(StMoSim)



```

##The data

Every two years, the Centers for Disease Control and Prevention conduct the Youth Risk Behavior Surveillance System (YRBSS) survey, where it takes data from high schoolers (9th through 12th grade), to analyze health patterns. You will work with a selected group of variables from a random sample of observations during one of the years the YRBSS was conducted.

Load the yrbss data set into your workspace.


```{r }

data(yrbss)
yrbss
?yrbss

#There are observations on 13 different variables, some categorical and some numerical. The meaning of each variable can be found by bringing up the help file:

```

## Exercice1 
#  What are the cases in this data set? How many cases are there in our sample?
# There are observations on 13 different variables in this 13583 sample (after cleanup)...the cases are about students male and female from ages 14 to 19 on various activities. 

```{r }

view(yrbss1)
glimpse(yrbss)

#is.na(airlines_arrival2) # checking if there is a missing data in the dataset, return is yes
#sum(is.na(airlines_arrival2)) # file to big, checking the sum of all missing data (return is 09 missing data)
yrbss1 <- na.omit(yrbss) # delete/remove the missings data because it is an imcomplete observation

```

### Exploratory data analysis

You will first start with analyzing the weight of the participants in kilograms: weight.

Using visualization and summary statistics, describe the distribution of weights. The summary function can be useful.

# Exercie 2 
How many observations are we missing weights from? I already cleaned up all the misses

```{r }

summary(yrbss$weight1)


```

Next, consider the possible relationship between a high schooler’s weight and their physical activity. Plotting the data is a useful first step because it helps us quickly visualize trends, identify strong associations, and develop research questions.

First, let’s create a new variable physical_3plus, which will be coded as either “yes” if they are physically active for at least 3 days a week, and “no” if not

```{r }

summary(yrbss$weight1)


```

# Exercice 3 
Make a side-by-side boxplot of physical_3plus and weight. Is there a relationship between these two variables? What did you expect and why?
# it is hard to say if there is a relationship between weight and physical activity. Thought, people who exercise more lose weight Vs. those who don't. 

```{r }

yrbss1 <- yrbss1 %>% 
  mutate(physical_3plus = ifelse(yrbss1$physically_active_7d > 2, "yes", "no"))
boxplot(yrbss1$weight, yrbss1$physical_3plus )
names = 

boxplot(weight ~ physical_3plus, data = yrbss1, xlab = "Physical Active",
   ylab = "Weights", main = "Activities by Weights" , col = c("green","purple"))
  
  
```


# Exercice 4: 
Are all conditions necessary for inference satisfied? Comment on each. You can compute the group sizes with the summarize command above by defining a new variable with the definition n().
Answer: Yes, conditions for inference are satisfied.
        we assume independent sample since the the problem statement did not let's to think otherwise
        Large sample
        Normal distribution (male/female...age spread from 14 to 18 etc...)
The mean_weight : "no" physical_3plus = 67.15; "yes" physical_3plus = 68.68

```{r }

# The box plots show how the medians of the two distributions compare, but we can also compare the means of the distributions using the following to first group the data by the physical_3plus variable, and then calculate the mean weight in these groups using the mean function while ignoring missing values by setting the na.rm argument to TRUE.
# 
# There is an observed difference, but is this difference statistically significant? In order to answer this question we will conduct a hypothesis test.

yrbss1 %>%
  group_by(physical_3plus) %>%
  summarise(mean_weight = mean(weight, na.rm = TRUE))


```

#Exercice 5
Write the hypotheses for testing if the average weights are different for those who exercise at least times a week and those who don’t.
Answer: H_nul = there is no difference in the average weights are different for those who exercise at least 02 times a week and those who don’t.
        H_alt = there is difference in the average weights are different for those who exercise at least 02 times a week and those who don’t.

Next, we will introduce a new function, hypothesize, that falls into the infer workflow. You will use this method for conducting hypothesis tests.

But first, we need to initialize the test, which we will save as obs_diff.


```{r }

obs_diff <- yrbss1 %>%
  specify(weight ~ physical_3plus) %>%
  calculate(stat = "diff in means", order = c("yes", "no"))

```

Notice how you can use the functions specify and calculate again like you did for calculating confidence intervals. Here, though, the statistic you are searching for is the difference in means, with the order being yes - no != 0.

After you have initialized the test, you need to simulate the test on the null distribution, which we will save as null.


```{r }

null_dist <- yrbss1 %>%
  specify(weight ~ physical_3plus) %>%
  hypothesize(null = "independence") %>%
  generate(reps = 1000, type = "permute") %>%
  calculate(stat = "diff in means", order = c("yes", "no"))

```

Here, hypothesize is used to set the null hypothesis as a test for independence. In one sample cases, the null argument can be set to “point” to test a hypothesis relative to a point estimate.

Also, note that the type argument within generate is set to permute, which is the argument when generating a null distribution for a hypothesis test.

We can visualize this null distribution with the following code:



```{r }


ggplot(data = null_dist, aes(x = stat)) +
  geom_histogram()


```

## 7.34 Email outreach efforts. A medical research group is recruiting people to complete short surveys
about their medical history. For example, one survey asks for information on a person's family history in
regards to cancer. Another survey asks about what topics were discussed during the person's last visit to a
hospital. So far, as people sign up, they complete an average of just 4 surveys, and the standard deviation
of the number of surveys is about 2.2. The research group wants to try a new interface that they think will
encourage new enrollees to complete more surveys, where they will randomize each enrollee to either get the
new interface or the current interface. How many new enrollees do they need for each interface to detect an
effect size of 0.5 surveys per enrollee, if the desired power level is 80%?

#Answer: they need n = 304 new enrollees for each interface to detect an effect size of 0.5 surveys per enrollee, if the desired power level is 80%

```{r }
sd <- 2.2
mean <- 4
power_level <- 0.80
effect_size <- 0.5
z_score80 <- qnorm(0.80)
z_score5 <- qnorm(0.975)
n <- 2*((z_score80 + z_score5)^2) * ((sd)^2/effect_size^2)
n


```

## Work hours and education. The General Social Survey collects data on demographics, education, and work, among many other characteristics of US residents.47 Using ANOVA, we can consider educational attainment levels for all 1,172 respondents at once. Below are the distributions of hours worked by educational attainment and relevant summary statistics that will be helpful in carrying out this analysis. Educational attainment
 
      Less than HS   HS		   Jr Coll      	Bachelor’s	Graduate	    Total
              
Mean	  38.67	      39.6	   41.39  	42.55	      40.85	        40.45
SD    	15.81	      14.97	   18.1	    13.62	      15.51	        15.17
n	      121	        546	     97	      253	        155	          1,172
 
# (a)	Write hypotheses for evaluating whether the average number of hours worked varies across the five groups.
Answer: H_null there is no difference in the average number of hours worked varies across the five groups.
        H_alt  there is difference in the average number of hours worked varies across the five groups.
        
#(b)	Check conditions and describe any assumptions you must make to proceed with the test.
Answer: the sample is independent, sample size is large, ditribution seems normal.

(c)	Below is part of the output associated with this test. Fill in the empty cells.

          	Df    Sum sq     	Mean sq  	   F-value	     Pr(>F)
degree	  XXXXX	  XXXXX	      501.54	     XXXXX	      0.0682
Residuals XXXXX	  267,382	    XXXXX		     
Total	    XXXXX   XXXXX

df_deg  = 4  , df_Resi = 1167 , df_total = 1171, sumsq_deg = 2006.16, sumsq_total = 269388.2 ,  meansq_Resi = 229.12, F_value = 2.2

#(d)	What is the conclusion of the test?
#Answer: p_value = 0.0682 > alpha (0.05 ) , so based on the 95% CI , we reject the H_null, thus, there is difference in the average number of hours worked varies across the five groups


```{r }

k <- 5
n  <- 121+546+97+253+155
df_deg <- k-1
df_deg 
df_Resi <- n-k
df_Resi
df_total <- df_Resi + df_deg 
df_total
meansq_deg <- 501.54

sumsq_Resi <- 267382
sumsq_deg <- df_deg*meansq_deg 
sumsq_deg
sumsq_total <- sumsq_Resi + sumsq_deg
sumsq_total 
meansq_Resi <- sumsq_Resi/ df_Resi
meansq_Resi

F_value <- meansq_deg/meansq_Resi
F_value
p_value <- pf(F_value, df_deg, df_Resi, lower.tail = FALSE)
p_value


```
